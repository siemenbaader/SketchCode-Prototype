<?xml version='1.0' encoding='UTF-8'?>
<html xmlns='http://www.w3.org/1999/xhtml'>
  <head>
    <title> Interactive </title>
    <script src="jquery-1.4.4.js"/>
    <script src="helpers.js"/> 
  </head>

  <body>
    <style>
      body {background-color: gray; }
    
/*       .console:focus {outline: 5px solid blue; } */
    </style>

    <style> /* Editor */
      
      editor { display: block; width: 500px; height: 400px;}
      .console {background-color: black; color: white; font-family: monospace; padding: 5px; height: auto;} 

      #file-content{
         width: 100%; min-height: 700px; overflow: scroll;}
      filetabs file { border: 1px solid black; border-bottom: none; padding: 5px; font-family: sans-serif; font-size: 14px; background-color: #BBB; }
      file#current { font-weight: bold; background-color: white;}


    interactive { display: table; position: absolute; left: 540px; top: 27px; background-color: white; border: 1px solid black; padding: 0; }

    interactive line { display: table-row; border-bottom: 1px solid black; }
    interactive line * { display: table-cell; vertical-align: middle; }    
    
    interactive log {font-style: italic; width: 200px; }
    interactive line .delete-button { position: realtive; top: 0px; padding-right:10px; }
    interactive line .console { min-height: 40px; min-width: 300px;}

    </style>


  <editor>
    <filetabs> 
      <file id="current">socket.js</file>
      <file>helper.js</file>
      <file>index.xhtml</file>
    </filetabs>
    <textarea id="file-content" class='console' ><![CDATA[
print "hello from python"
    ]]></textarea>
  </editor>



  <interactive>
    <line>
      <textarea class="console action">var data = {foo: 2, send: "true"};
send(data);</textarea>
      <log>"Hello from server"</log>
      <img class="delete-button" src="close.png" width="20px"/>
    </line>
    <line style="background-color: #CCC">
      <textarea class="console action">var data = {foo: 2, send: "true"};
send(data);</textarea>
      <log>"Hello from server"</log>
      <img class="delete-button" src="close.png" width="20px"/>
    </line>
    <line>
      <textarea class="console action">p(10 -10);</textarea>
      <log>0</log>
      <img class="delete-button" src="close.png" width="20px"/>
    </line>

   
  </interactive>


    <script><![CDATA[

      var file_content = $("#file-content")[0];
//       var source = document.getElementById("source");
//       var out = document.getElementsByTagName("out")[0];
//       var js = document.getElementById("js");
//       
      var ws = new WebSocket('ws://localhost:11112');
			
			ws.onopen = function() {

				console.log('open!');
			};
			ws.onmessage = function(evt) {
				console.log(evt.data);
			};      

      document.onkeydown = function (ev) {
        if (ev.keyIdentifier === "Enter" && ev.ctrlKey) {
	  ws.send(JSON.stringify(file_content.value));
          
        }
      };
      
//       source.value = localStorage["source"];
//       js.value = localStorage["js"];
//       out.innerHTML = source.value;
//      
//       source.focus();
    ]]></script>

  </body>
</html>
